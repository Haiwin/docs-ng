<?xml version="1.0" encoding="utf-8"?><?workdir /Users/Ruth/forks/docs-ng/dita/src/ag3/temp/pdf/oxygen_dita_temp/Tasks?><?workdir-uri file:/Users/Ruth/forks/docs-ng/dita/src/ag3/temp/pdf/oxygen_dita_temp/tasks/?><?path2project ../?><concept xmlns:ditaarch="http://dita.oasis-open.org/architecture/2005/" id="concept_cqg_2zf_q4" ditaarch:DITAArchVersion="1.2" domains="(topic concept)                            (topic hi-d)                             (topic ut-d)                             (topic indexing-d)                            (topic hazard-d)                            (topic abbrev-d)                            (topic pr-d)                             (topic sw-d)                            (topic ui-d)    " class="- topic/topic concept/concept " xtrf="/Users/Ruth/forks/docs-ng/dita/src/ag3/tasks/rebalance-swap-rebalance.dita" xtrc="concept:1;3:34">
 <title class="- topic/title " xtrf="/Users/Ruth/forks/docs-ng/dita/src/ag3/tasks/rebalance-swap-rebalance.dita" xtrc="title:1;4:9">Swap rebalance</title>
 <shortdesc class="- topic/shortdesc " xtrf="/Users/Ruth/forks/docs-ng/dita/src/ag3/tasks/rebalance-swap-rebalance.dita" xtrc="shortdesc:1;5:13">Swap Rebalance is an automatic feature that optimizes the
  movement of data when you are adding and removing the same number of nodes within the same
  operation. </shortdesc>
 <conbody class="- topic/body  concept/conbody " xtrf="/Users/Ruth/forks/docs-ng/dita/src/ag3/tasks/rebalance-swap-rebalance.dita" xtrc="conbody:1;8:11">
  
  <p class="- topic/p " xtrf="/Users/Ruth/forks/docs-ng/dita/src/ag3/tasks/rebalance-swap-rebalance.dita" xtrc="p:1;10:6">The swap rebalance optimizes the rebalance operation by moving data directly from the
   nodes being removed to the nodes being added. This is more efficient than standard rebalancing
   which would normally move data across the entire cluster.</p><p class="- topic/p " xtrf="/Users/Ruth/forks/docs-ng/dita/src/ag3/tasks/rebalance-swap-rebalance.dita" xtrc="p:2;12:68">Swap rebalance only occurs if
    the following are true:</p><ul class="- topic/ul " xtrf="/Users/Ruth/forks/docs-ng/dita/src/ag3/tasks/rebalance-swap-rebalance.dita" xtrc="ul:1;13:36">
     <li class="- topic/li " xtrf="/Users/Ruth/forks/docs-ng/dita/src/ag3/tasks/rebalance-swap-rebalance.dita" xtrc="li:1;14:10"><p class="- topic/p " xtrf="/Users/Ruth/forks/docs-ng/dita/src/ag3/tasks/rebalance-swap-rebalance.dita" xtrc="p:3;14:13">You are removing and adding the same number of nodes during rebalance. For example, if
      you have marked two nodes to be removed, and added another two nodes to the cluster.</p></li>
     <li class="- topic/li " xtrf="/Users/Ruth/forks/docs-ng/dita/src/ag3/tasks/rebalance-swap-rebalance.dita" xtrc="li:2;16:10"><p class="- topic/p " xtrf="/Users/Ruth/forks/docs-ng/dita/src/ag3/tasks/rebalance-swap-rebalance.dita" xtrc="p:4;16:13">When Couchbase Server identifies that a rebalance is taking place and that there are an
      even number of nodes being removed and added to the cluster, the swap rebalance method is used
      to perform the rebalance operation.</p></li>
    </ul><p class="- topic/p " xtrf="/Users/Ruth/forks/docs-ng/dita/src/ag3/tasks/rebalance-swap-rebalance.dita" xtrc="p:5;19:13">Swap rebalance occurs automatically if the number of nodes being added and removed are
     identical. There is no configuration or selection mechanism to force a swap rebalance. If a swap
     rebalance cannot take place, then a normal rebalance operation will be used instead.</p><p class="- topic/p " xtrf="/Users/Ruth/forks/docs-ng/dita/src/ag3/tasks/rebalance-swap-rebalance.dita" xtrc="p:6;21:97">When
      a swap rebalance takes place, the rebalance operates as follows:</p><ul class="- topic/ul " xtrf="/Users/Ruth/forks/docs-ng/dita/src/ag3/tasks/rebalance-swap-rebalance.dita" xtrc="ul:2;22:79">
       <li class="- topic/li " xtrf="/Users/Ruth/forks/docs-ng/dita/src/ag3/tasks/rebalance-swap-rebalance.dita" xtrc="li:3;23:12"><p class="- topic/p " xtrf="/Users/Ruth/forks/docs-ng/dita/src/ag3/tasks/rebalance-swap-rebalance.dita" xtrc="p:7;23:15">Data will be moved directly from a node being removed to a node being added on a
        one-to-one basis. This eliminates the need to restructure the entire vBucket map.</p></li>
       <li class="- topic/li " xtrf="/Users/Ruth/forks/docs-ng/dita/src/ag3/tasks/rebalance-swap-rebalance.dita" xtrc="li:4;25:12"><p class="- topic/p " xtrf="/Users/Ruth/forks/docs-ng/dita/src/ag3/tasks/rebalance-swap-rebalance.dita" xtrc="p:8;25:15">Active vBuckets are moved, one at a time, from a source node to a destination
        node.</p></li>
       <li class="- topic/li " xtrf="/Users/Ruth/forks/docs-ng/dita/src/ag3/tasks/rebalance-swap-rebalance.dita" xtrc="li:5;27:12"><p class="- topic/p " xtrf="/Users/Ruth/forks/docs-ng/dita/src/ag3/tasks/rebalance-swap-rebalance.dita" xtrc="p:9;27:15">Replica vBuckets are created on the new node and populated with existing data before
        being activated as the live replica bucket. This ensures that if there is a failure during the
        rebalance operation, that your replicas are still in place.</p></li>
      </ul><p class="- topic/p " xtrf="/Users/Ruth/forks/docs-ng/dita/src/ag3/tasks/rebalance-swap-rebalance.dita" xtrc="p:10;30:15">For example, if you have a cluster with 20 nodes in it, and configure two nodes (X and Y)
       to be added, and two nodes to be removed (A and B):</p><ul class="- topic/ul " xtrf="/Users/Ruth/forks/docs-ng/dita/src/ag3/tasks/rebalance-swap-rebalance.dita" xtrc="ul:3;31:67">
        <li class="- topic/li " xtrf="/Users/Ruth/forks/docs-ng/dita/src/ag3/tasks/rebalance-swap-rebalance.dita" xtrc="li:6;32:13"><p class="- topic/p " xtrf="/Users/Ruth/forks/docs-ng/dita/src/ag3/tasks/rebalance-swap-rebalance.dita" xtrc="p:11;32:16">vBuckets from node A will be moved to node X.</p></li>
        <li class="- topic/li " xtrf="/Users/Ruth/forks/docs-ng/dita/src/ag3/tasks/rebalance-swap-rebalance.dita" xtrc="li:7;33:13"><p class="- topic/p " xtrf="/Users/Ruth/forks/docs-ng/dita/src/ag3/tasks/rebalance-swap-rebalance.dita" xtrc="p:12;33:16">vBuckets from node B will be moved to node Y.</p></li>
       </ul><p class="- topic/p " xtrf="/Users/Ruth/forks/docs-ng/dita/src/ag3/tasks/rebalance-swap-rebalance.dita" xtrc="p:13;34:16">The benefits of swap rebalance are:</p><ul class="- topic/ul " xtrf="/Users/Ruth/forks/docs-ng/dita/src/ag3/tasks/rebalance-swap-rebalance.dita" xtrc="ul:4;34:59">
        <li class="- topic/li " xtrf="/Users/Ruth/forks/docs-ng/dita/src/ag3/tasks/rebalance-swap-rebalance.dita" xtrc="li:8;35:13"><p class="- topic/p " xtrf="/Users/Ruth/forks/docs-ng/dita/src/ag3/tasks/rebalance-swap-rebalance.dita" xtrc="p:14;35:16">Reduced rebalance duration. Since the move takes place directly from the nodes being
         removed to the nodes being added.</p></li>
        <li class="- topic/li " xtrf="/Users/Ruth/forks/docs-ng/dita/src/ag3/tasks/rebalance-swap-rebalance.dita" xtrc="li:9;37:13"><p class="- topic/p " xtrf="/Users/Ruth/forks/docs-ng/dita/src/ag3/tasks/rebalance-swap-rebalance.dita" xtrc="p:15;37:16">Reduced load on the cluster during rebalance.</p></li>
        <li class="- topic/li " xtrf="/Users/Ruth/forks/docs-ng/dita/src/ag3/tasks/rebalance-swap-rebalance.dita" xtrc="li:10;38:13"><p class="- topic/p " xtrf="/Users/Ruth/forks/docs-ng/dita/src/ag3/tasks/rebalance-swap-rebalance.dita" xtrc="p:16;38:16">Reduced network overhead during the rebalance.</p></li>
        <li class="- topic/li " xtrf="/Users/Ruth/forks/docs-ng/dita/src/ag3/tasks/rebalance-swap-rebalance.dita" xtrc="li:11;39:13"><p class="- topic/p " xtrf="/Users/Ruth/forks/docs-ng/dita/src/ag3/tasks/rebalance-swap-rebalance.dita" xtrc="p:17;39:16">Reduced chance of a rebalance failure if a failover occurs during the rebalance
         operation, since replicas are created in tandem on the new hosts while the old host replicas
         still remain available.</p></li>
        <li class="- topic/li " xtrf="/Users/Ruth/forks/docs-ng/dita/src/ag3/tasks/rebalance-swap-rebalance.dita" xtrc="li:12;42:13"><p class="- topic/p " xtrf="/Users/Ruth/forks/docs-ng/dita/src/ag3/tasks/rebalance-swap-rebalance.dita" xtrc="p:18;42:16">Because data on the nodes are swapped, rather than performing a full rebalance, the
         capacity of the cluster remains unchanged during the rebalance operation, helping to ensure
         performance and failover support.</p></li>
       </ul>
  
  <p class="- topic/p " xtrf="/Users/Ruth/forks/docs-ng/dita/src/ag3/tasks/rebalance-swap-rebalance.dita" xtrc="p:19;47:6">The behavior of the cluster during a failover and rebalance operation with the swap
        rebalance functionality affects the following situations:</p>
  
         <ul class="- topic/ul " xtrf="/Users/Ruth/forks/docs-ng/dita/src/ag3/tasks/rebalance-swap-rebalance.dita" xtrc="ul:5;50:14"><li class="- topic/li " xtrf="/Users/Ruth/forks/docs-ng/dita/src/ag3/tasks/rebalance-swap-rebalance.dita" xtrc="li:13;50:18">Stopping a rebalance
        <p class="- topic/p " xtrf="/Users/Ruth/forks/docs-ng/dita/src/ag3/tasks/rebalance-swap-rebalance.dita" xtrc="p:20;51:12">If rebalance fails, or has been deliberately stopped, the active and replica vBuckets
         that have been transitioned will be part of the active vBucket map. Any transfers still in
         progress will be canceled. Restarting the rebalance operation will continue the rebalance from
         where it left off.</p></li>
         <li class="- topic/li " xtrf="/Users/Ruth/forks/docs-ng/dita/src/ag3/tasks/rebalance-swap-rebalance.dita" xtrc="li:14;55:14">Adding back a failed node
         <p class="- topic/p " xtrf="/Users/Ruth/forks/docs-ng/dita/src/ag3/tasks/rebalance-swap-rebalance.dita" xtrc="p:21;56:13">When a node has failed, removing it and adding a replacement node, or adding the node
          back, will be treated as swap rebalance.</p></li>
         </ul>
           
           <note type="important" class="- topic/note " xtrf="/Users/Ruth/forks/docs-ng/dita/src/ag3/tasks/rebalance-swap-rebalance.dita" xtrc="note:1;60:35">With swap rebalance
           functionality, after a node has failed over, either clean up and re-add the failed over node, or
           add a new node and perform a rebalance as normal. The rebalance is handled as a swap
           rebalance which minimize the data movements without affecting the overall capacity of the
           cluster.
          </note>
         
  
  
 </conbody>
<related-links class="- topic/related-links "><linkpool class="- topic/linkpool " xtrc="topicref:50;59:58" xtrf="/Users/Ruth/forks/docs-ng/dita/src/ag3/Admin.ditamap"><link class="- topic/link " mapclass="- map/topicref " type="topic" xtrc="topicref:47;56:47" xtrf="/Users/Ruth/forks/docs-ng/dita/src/ag3/Admin.ditamap" href="../Tasks/tasks-rebalance.dita" role="parent"><?ditaot usertext?><linktext class="- topic/linktext "><?ditaot gentext?>Rebalancing</linktext></link></linkpool></related-links>
</concept>