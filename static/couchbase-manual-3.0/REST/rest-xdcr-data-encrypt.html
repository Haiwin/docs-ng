<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="description" content="Couchbase Server product documentation"><style>
					body{
						padding-top:40px; /* make the container go all the way to the bottom of the top bar */
					}</style><script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script><link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.min.css" rel="stylesheet"><script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.js"></script><link rel="stylesheet" href="//yandex.st/highlightjs/8.0/styles/default.min.css"><script src="//yandex.st/highlightjs/8.0/highlight.min.js"></script><link href="http://fonts.googleapis.com/css?family=Open+Sans:400italic,400,700" rel="stylesheet" type="text/css"><link href="/assets-dita/css/base.css" rel="stylesheet"><script src="/assets-dita/js/main.js"></script></head><body><header class="navbar navbar-fixed-top"><div class="navbar-inner"><div class="container-fluid container"><a class="brand" href="http://www.couchbase.com/"><img src="/assets-dita/images/cb-icon-sofa.png" class="logo"></a><a class="brand" style="color:#000552;" href="/">Couchbase Documentation <small>beta</small></a><div class="nav-collapse collapse"><ul class="nav"><li><a href="/">Docs Home</a></li><li><a href="/archive-index">Docs Archive</a></li></ul></div></div></div></header><div id="content" class="container-fluid container"><div class="row-fluid"><nav class="span3"><div class="well"><ul class="nav nav-list"><li><a href="../beta-intro.html">Couchbase 3.0 beta introduction</a></li><li><a href="../Features/features.html">Couchbase 3.0 Features</a></li><li><a href="../install-intro.html">Couchbase Installation</a></li><li><a href="../admin-intro.html">Couchbase Administration</a></li><li><a href="../cli-intro.html">Couchbase CLI</a></li><li><a href="../rest-intro.html">Couchbase REST API</a><ul class="nav nav-list"><li><a href="../REST/overview-rest-api.html">REST API overview</a></li><li><a href="../REST/rest-cluster-intro.html">Cluster REST API</a></li><li><a href="../REST/rest-server-nodes.html">Server nodes REST API</a></li><li><a href="../REST/rest-rza.html">Rack Awareness REST API</a></li><li><a href="../REST/rest-bucket-intro.html">Buckets REST API</a></li><li><a href="../REST/rest-views-intro.html">Views REST API</a></li><li><a href="../REST/rest-xdcr-intro.html">XDCR REST API</a><ul class="nav nav-list"><li><a href="../REST/rest-xdcr-create-ref.html">Creating a destination cluster reference</a></li><li><a href="../REST/rest-xdcr-create-replication.html">Creating XDCR replications</a></li><li class="active"><a href="../REST/rest-xdcr-data-encrypt.html">Managing XDCR data encryption</a><ul class="nav nav-list"></ul></li><li><a href="../REST/rest-xdcr-delete-ref.html">Deleting a destination cluster reference</a></li><li><a href="../REST/rest-xdcr-delete-replication.html">Deleting XDCR replications</a></li><li><a href="../REST/rest-xdcr-edit-internal.html">Changing internal XDCR settings</a></li><li><a href="../REST/rest-xdcr-get-internal.html">Viewing internal XDCR settings</a></li><li><a href="../REST/rest-xdcr-get-ref.html">Getting a destination cluster reference</a></li><li><a href="../REST/rest-xdcr-statistics.html">Getting XDCR stats via REST</a></li></ul></li><li><a href="../REST/compaction-rest-api.html">Compaction REST API</a></li><li><a href="../REST/logs-rest-api.html">Logs REST API</a></li><li><a href="../REST/rest-users.html">Users REST API</a></li></ul></li><li><a href="../rel-notes/rel-notes3.0beta.html">Release notes (beta)</a></li></ul></div></nav><main class="span9">
  <h1 class="title topictitle1">Managing XDCR data encryption</h1>

  <div class="body">
    <p class="p">The process for configuring XDCR with data encryption (Enterprise Edition only) involves
      configuring the XDCR cluster reference with data encryption enabled, providing the SSL
      certificate, and configuring replication.</p>

    <p class="p">The following summarizes the HTTP methods used for defining XDCR data encryption:</p>

    
<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" class="table" frame="border" border="1" rules="all">
        
        
        
        <thead class="thead" align="left">
          <tr class="row">
            <th class="entry" valign="top" id="d99593e32">HTTP method</th>

            <th class="entry" valign="top" id="d99593e35">URI path</th>

            <th class="entry" valign="top" id="d99593e38">Description</th>

          </tr>

        </thead>

        <tbody class="tbody">
          <tr class="row">
            <td class="entry" valign="top" headers="d99593e32 ">GET</td>

            <td class="entry" valign="top" headers="d99593e35 "><samp class="ph codeph">/pools/default/remoteClusters</samp></td>

            <td class="entry" valign="top" headers="d99593e38 ">Gets the destination cluster reference</td>

          </tr>

          <tr class="row">
            <td class="entry" valign="top" headers="d99593e32 ">POST</td>

            <td class="entry" valign="top" headers="d99593e35 "><samp class="ph codeph">/pools/default/remoteClusters</samp></td>

            <td class="entry" valign="top" headers="d99593e38 ">Creates a reference to the destination cluster</td>

          </tr>

          <tr class="row">
            <td class="entry" valign="top" headers="d99593e32 ">PUT</td>

            <td class="entry" valign="top" headers="d99593e35 "><samp class="ph codeph">/pools/default/remoteClusters/UUID</samp></td>

            <td class="entry" valign="top" headers="d99593e38 ">Modifies the destination cluster reference</td>

          </tr>

          <tr class="row">
            <td class="entry" valign="top" headers="d99593e32 ">DELETE</td>

            <td class="entry" valign="top" headers="d99593e35 "><samp class="ph codeph">/pools/default/remoteClusters/UUID</samp></td>

            <td class="entry" valign="top" headers="d99593e38 ">Deletes the reference to the destination cluster.</td>

          </tr>

        </tbody>

      </table>
</div>

    <div class="section"><h2 class="title sectiontitle">Retrieving certificates</h2><p class="p">To retrieve the SSL certificate from the
        destination cluster to the source cluster:</p>
<p class="p"><strong class="ph b">Destination
          endpoint</strong></p>
<p class="p"><samp class="ph codeph">/pools/default/certificate</samp></p>
<p class="p"><strong class="ph b">Example</strong></p>
<pre class="pre codeblock"><samp class="ph codeph">curl http://remoteHost:port/pools/default/certificate &gt; ./remoteCert.pem
</samp></pre>
</div>

    <div class="section"><h2 class="title sectiontitle">Regenerating certificates</h2><p class="p">To regenerate a certificate on a destination
        cluster:</p>
<p class="p"><strong class="ph b">Destination
          endpoint</strong></p>
<p class="p"><samp class="ph codeph">/controller/regenerateCertificate</samp></p>
<p class="p"><strong class="ph b">Example</strong></p>
<pre class="pre codeblock"><samp class="ph codeph">curl -X POST http://Administrator:asdasd@remoteHost:8091/controller/regenerateCertificate
</samp></pre>
</div>

    
    
    <div class="section"><h2 class="title sectiontitle">Configuring XDCR with data encryption</h2><p class="p">A POST to
          <samp class="ph codeph">/pools/default/remoteClusters</samp> creates the XDCR cluster reference from the
        source cluster to the destination cluster. Setting the <samp class="ph codeph">demandEncryption</samp> to
        one (1) and providing the certificate name and location enables data
          encryption.</p>
<p class="p"><strong class="ph b">Destination endpoint</strong></p>
<p class="p"><samp class="ph codeph">POST
          /pools/default/remoteClusters</samp> creates the destination cluster
          reference.</p>
<p class="p"><samp class="ph codeph">PUT /pools/default/remoteClusters</samp> modifies the
        destination cluster
          reference.</p>

      
      <p class="p"><strong class="ph b">Syntax</strong></p>
<pre class="pre codeblock"><samp class="ph codeph">curl –X POST  -u Admin:myPassword
  http://localHost:port/pools/default/remoteClusters 
  -d name=&lt;clusterName&gt;             // Remote cluster name
  -d hostname=&lt;host&gt;:&lt;port&gt;         // FQDN of the remote host.
  -d username=&lt;adminName&gt;           // Remote cluster Admin name
  -d password=&lt;adminPassword&gt;       // Remote cluster Admin password
  -d demandEncryption=[0|1] --data-urlencode "certificate=$(cat remoteCert.pem)"
</samp></pre>
<p class="p"><strong class="ph b">Example</strong></p>
<pre class="pre codeblock"><samp class="ph codeph">curl –X POST 
-d name=remoteName  
-d hostname=10.3.4.187:8091
-d username=remoteAdmin –d password=remotePassword
-d demandEncryption=1 --data-urlencode "certificate=$(cat remoteCert.pem)"
http://Administrator:asdasd@192.168.0.1:8091/pools/default/remoteClusters/
</samp></pre>
</div>

    <div class="section"><h2 class="title sectiontitle">Disabling data encryption</h2><p class="p">To modify the XDCR configuration so that SSL
        data encryption is disabled, execute a PUT from the source cluster to the destination
        cluster with <samp class="ph codeph">demandEncryption=0</samp>.</p>
<p class="p"><strong class="ph b">Destination
          endpoint</strong></p>
<p class="p"><samp class="ph codeph">/pools/default/remoteClusters</samp></p>
<p class="p"><strong class="ph b">Example</strong></p>
<pre class="pre codeblock"><samp class="ph codeph">curl –X PUT  -u Admin:myPassword
  http://192.168.0.1:8091/pools/default/remoteClusters/
-d name=remoteName 
-d hostname=10.3.4.187:8091
-d username=remoteAdmin –d password=remotePassword
-d demandEncryption=0
</samp></pre>
</div>

  </div>

<div class="related-links">
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a class="link" href="../REST/rest-xdcr-intro.html" title="Cross Datacenter Replication (XDCR) enables you to automatically replicate data between clusters and between data buckets.">XDCR REST API</a></div>
</div>
</div></main></div></div><footer><div class="navbar navbar-fixed-bottom"><div class="navbar-inner"><div class="container-fluid container"><div class="copyright">
								© 2014 COUCHBASE All rights reserved.
							</div></div></div></div></footer><script type="text/javascript" src="https://www.google.com/jsapi"></script><script>
					(function() {
					var cx = '018016427239405524608:fkg1v30apnm';
					var gcse = document.createElement('script');
					gcse.type = 'text/javascript';
					gcse.async = true;
					gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
					'//www.google.com/cse/cse.js?cx=' + cx;
					var s = document.getElementsByTagName('script')[0];
					s.parentNode.insertBefore(gcse, s);
					})();
				</script></body></html>