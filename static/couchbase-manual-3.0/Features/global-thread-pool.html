<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="description" content="Couchbase Server product documentation"><style>
					body{
						padding-top:40px; /* make the container go all the way to the bottom of the top bar */
					}</style><script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script><link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.min.css" rel="stylesheet"><script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.js"></script><link rel="stylesheet" href="//yandex.st/highlightjs/8.0/styles/default.min.css"><script src="//yandex.st/highlightjs/8.0/highlight.min.js"></script><link href="http://fonts.googleapis.com/css?family=Open+Sans:400italic,400,700" rel="stylesheet" type="text/css"><link href="../css/base.css" rel="stylesheet"><script src="../js/main.js"></script></head><body><header class="navbar navbar-fixed-top"><div class="navbar-inner"><div class="container-fluid container"><a class="brand" href="http://www.couchbase.com/"><img src="../images/cb-icon-sofa.png" class="logo"></a><a class="brand" style="color:#000552;" href="/">Couchbase Documentation <small>beta</small></a><div class="nav-collapse collapse"><ul class="nav"><li><a href="/">Docs Home</a></li><li><a href="/archive-index.html">Docs Archive</a></li></ul></div></div></div></header><div id="content" class="container-fluid container"><div class="row-fluid"><nav class="span3"><div class="well"><ul class="nav nav-list"><li><a href="../beta-intro.html">Couchbase 3.0 beta introduction</a></li><li><a href="../Features/features.html">Couchbase 3.0 Features</a><ul class="nav nav-list"><li><a href="../Features/bcp.html">Database Change Protocol</a></li><li class="active"><a href="../Features/global-thread-pool.html">Shared thread pool</a><ul class="nav nav-list"></ul></li><li><a href="../Features/bucket-eviction.html">Metadata ejection</a></li><li><a href="../Features/bucket-priority.html">Disk I/O priority</a></li><li><a href="../Features/graceful-failover.html">Graceful failover</a></li><li><a href="../Features/delta-node-recovery.html">Delta node recovery</a></li><li><a href="../Features/increment-backup.html">Incremental backup and restore</a></li><li><a href="../Features/index-updates.html">Stream-based views</a></li><li><a href="../Features/xdcr-memory-replication.html">Stream-based XDCR</a></li><li><a href="../Features/security-admin-access.html">Encrypted admin access</a></li><li><a href="../Features/security-clientServer-comm.html">Encrypted data access</a></li><li><a href="../Features/security-client-ssl.html">Configuring clients for SSL</a></li><li><a href="../Features/cluster-wide-info-intro.html">Cluster-wide diagnostics</a></li></ul></li><li><a href="../install-intro.html">Couchbase Installation</a></li><li><a href="../admin-intro.html">Couchbase Administration</a></li><li><a href="../cli-intro.html">Couchbase CLI</a></li><li><a href="../rest-intro.html">Couchbase REST API</a></li><li><a href="../rel-notes/rel-notes3.0beta.html">Release notes (beta)</a></li></ul></div></nav><main class="span9">

 <h1 class="title topictitle1">Shared thread pool</h1>

 
 
 <div class="body conbody"><p class="shortdesc">Shared thread pool optimizes dispatch tasks by decoupling buckets from thread allocation.</p>

   <p class="p">Threads and buckets are decoupled in the thread management which allows threads to run tasks
   for any bucket based on the bucket prioritization. Since the global thread pool allows for bucket
   priority levels, a separate auxillary I/O queue is available with the reader and writer queues at
   every priority level. This provides improved task queueing. For example, when a thread is
   assigned to running a task from the auxIO queue and a second task comes in, another thread is
   assigned to pick up the next task.</p>

  
  <p class="p">In terms of thread scheduling, if all buckets have the same priority (default setting), each
   thread evenly round-robins over all the task queues of the buckets and then goes to sleep when
   all buckets are either empty or being serviced by other threads. If buckets have different
   priorities, the threads spend an appropriate fraction of time (scheduling frequency)
   dispatching tasks from queues of these bucket. </p>

  
  
   <p class="p">Threads are spawned based on system capabilities at initial startup of a server node instance. 
    These capabilities include, among other
    parameters, the number of CPU cores and the storage type (for example, SSD vs spindle disk).</p>

  
  <p class="p">Shared thread pool management promotes:</p>

  <ul class="ul">
   <li class="li">Dynamic thread allocation which provides balanced provisioning by using idle threads (CPU)
    and disk capacity</li>

   <li class="li">Higher parallelism for thread workers and I/O resource management</li>

   <li class="li">Scalability by supporting a very large number of buckets</li>

   <li class="li">Multi-tenancy, policy-based scheduling, higher throughput, and lower latency</li>

  </ul>

  
  <div class="fig fignone"><img class="image" src="../images/global-thread-pool.png" width="720" alt="Global Thread Pool diagram"></div>


  
  <div class="section"><h2 class="title sectiontitle">Impacted documentation</h2>
   <ul class="ul">
    <li class="li">Disk storage</li>

    <li class="li">Multiple readers and writers</li>

    <li class="li">Auxiliary I/O dispatcher</li>

    <li class="li">Reader/writer threads</li>

   </ul>

  </div>

  
 </div>

 
 <div class="related-links">
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a class="link" href="../Features/features.html">Couchbase 3.0 Features</a></div>
</div>

<div class="linklist linklist"><strong>Related topics</strong><br>

<div><a class="link" href="bucket-priority.html" title="Disk I/O priority refers to an advanced setting for optimizing I/O allocation.">Disk I/O priority</a></div>
<div><a class="link" href="../Monitoring/monitor-statistics.html" title="Couchbase Server provides statistics at multiple levels throughout the cluster.">Couchbase Server statistics</a></div>
<div><a class="link" href="../Concepts/concept-cacheLayer.html" title="Couchbase Server includes a built-in caching layer which acts as a central part of the server and provides very rapid reads and writes of data.">Caching layer</a></div>
<div><a class="link" href="../Concepts/concept-readerWriter.html" title="Multi-threaded readers and writers provide multiple processes to simultaneously read and write data on disk. Simultaneous reads and writes increases disk speed and improves the read rate from disk.">Multiple readers and writers</a></div></div>
</div>


</main></div></div><footer><div class="navbar navbar-fixed-bottom"><div class="navbar-inner"><div class="container-fluid container"><div class="copyright">
								Â© 2014 COUCHBASE All rights reserved.
							</div></div></div></div></footer></body></html>