<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="description" content="Couchbase Server documentation"><title>Couchbase Server statistics</title><script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css"><script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script><link rel="stylesheet" href="//yandex.st/highlightjs/8.0/styles/default.min.css"><script src="//yandex.st/highlightjs/8.0/highlight.min.js"></script><link href="http://fonts.googleapis.com/css?family=Open+Sans:400italic,400,700" rel="stylesheet" type="text/css"><link href="/assets-dita/css/base.css" rel="stylesheet"><script src="/assets-dita/js/main.js"></script></head><body><header class="navbar navbar-default navbar-fixed-top"><div class="container"><div class="navbar-header"><a class="navbar-brand" href="http://www.couchbase.com/"><img src="/assets-dita/images/cb-icon-sofa.png" class="logo"></a><a class="navbar-brand" style="color:#000552;" href="/">Couchbase
								Documentation <small>beta</small></a></div><div class="navbar-collapse collapse"><ul class="nav navbar-nav"><li><a href="/">Docs Home</a></li><li><a href="/archive-index">Docs Archive</a></li></ul></div></div></header><div id="content" class="container"><div class="row"><nav class="col-md-3"><div class="well"><ul class="nav nav-list list-group"><li><a href="../Couchbase-intro.html">Introduction</a></li><li><a href="../Features/features.html">Couchbase 3.0 features</a></li><li><a href="../install-intro.html">Installation and upgrade</a></li><li><a href="../admin-intro.html">Administration</a><ul class="nav nav-list"><li><a href="../Misc/admin-basics.html">Administration basics</a></li><li><a href="../Concepts/concept-intro.html">Architecture and concepts</a></li><li><a href="../Concepts/bp-deployment-considerations.html">Deployment considerations</a></li><li><a href="../Tasks/cluster-management.html">Cluster management</a></li><li><a href="../Monitoring/monitor-intro.html">Monitoring</a><ul class="nav nav-list"><li><a href="../Monitoring/monitor-underlying-processes.html">Underlying server processes</a></li><li><a href="../Monitoring/monitor-port-access.html">Port numbers and accessing different buckets</a></li><li><a href="../Monitoring/monitor-diskqueue.html">Disk write queue</a></li><li class="active"><a href="../Monitoring/monitor-statistics.html">Couchbase Server statistics</a><ul class="nav nav-list"></ul></li><li><a href="../Monitoring/monitor-moxi-statistics.html">Couchbase Server Moxi statistics</a></li><li><a href="../Monitoring/monitor-warmup.html">Monitoring startup (warmup)</a></li><li><a href="../Monitoring/monitor-rebalance.html">Monitoring a rebalance</a></li></ul></li><li><a href="../Views/views-intro.html">Views and indexes</a></li><li><a href="../XDCR/xdcr-intro.html">Cross Datacenter Replication (XDCR)</a></li><li><a href="../UI/ui-intro.html">Web console</a></li><li><a href="../Misc/faq.html">FAQs</a></li><li><a href="../Misc/sample-bucket-intro.html">Sample buckets</a></li><li><a href="../Misc/Trbl-intro.html">Troubleshooting</a></li><li><a href="../Misc/deprecated.html">Deprecated items</a></li></ul></li><li><a href="../cli-intro.html">CLI reference</a></li><li><a href="../rest-intro.html">REST API reference</a></li><li><a href="../rel-notes/rel-notes3.0-beta.html">Release notes 3.0 beta</a></li></ul></div></nav><main class="col-md-9"><div class="gcse-wrapper"><div class="gcse-search"></div></div>
  <h1 class="title topictitle1">Couchbase Server statistics</h1>

  
  <div class="body"><p class="shortdesc">Couchbase Server provides statistics at multiple levels throughout the cluster.</p>

    <p class="p">The statistics
      used for regular monitoring, capacity planning and to identify the performance characteristics
      of your cluster deployment. The most visible statistics are those in the Web UI, but
      components such as the REST interface, the proxy and individual nodes have directly accessible
      statistics interfaces.</p>

    <div class="section"><h2 class="title sectiontitle">REST interface statistics</h2><p class="p">To interact with statistics provided by
        REST, use the Couchbase web console. 
        This GUI gathers statistics via REST and displays them to your browser.
        The REST interface has a set of resources that provide access to the current and historic
        statistics the cluster gathers and stores.</p>
</div>

    
    <div class="section"><h2 class="title sectiontitle">Couchbase Server node statistics</h2><p class="p">Detailed stats documentation can be found in the
        repository.</p>
<p class="p">Along with stats at the REST and UI level, individual nodes can also be
        queried for statistics either through a client which uses binary protocol or through the
          cbstats utility.</p>
<p class="p">For
        example:</p>
<pre class="pre codeblock"><samp class="ph codeph">&gt; cbstats localhost:11210 all
 auth_cmds:                   9
 auth_errors:                 0
 bucket_conns:                10
 bytes_read:                  246378222
 bytes_written:               289715944
 cas_badval:                  0
 cas_hits:                    0
 cas_misses:                  0
 cmd_flush:                   0
 cmd_get:                     134250
 cmd_set:                     115750
…
</samp></pre>
<p class="p">The
        most commonly needed statistics are surfaced through the Web Console and have descriptions
        there and in the associated documentation. Software developers and system administrators
        wanting lower level information have it available through the stats interface.</p>
<p class="p">There
        are seven commands available through the stats interface:</p>
<ul class="ul">
        <li class="li"><p class="p"><samp class="ph codeph">stats</samp> (referred to as ‘all’)</p>
</li>

        <li class="li"><p class="p"><samp class="ph codeph">dispatcher</samp></p>
</li>

        <li class="li"><p class="p"><samp class="ph codeph">hash</samp></p>
</li>

        <li class="li"><p class="p"><samp class="ph codeph">tap</samp></p>
</li>

        <li class="li"><p class="p"><samp class="ph codeph">timings</samp></p>
</li>

        <li class="li"><p class="p"><samp class="ph codeph">vkey</samp></p>
</li>

        <li class="li"><p class="p"><samp class="ph codeph">reset</samp></p>
</li>

      </ul>
</div>

    <div class="section"><h2 class="title sectiontitle">stats command</h2><p class="p">This displays a large list of statistics related to the
        Couchbase process including the underlying engine (ep_* stats).</p>
</div>

    <div class="section"><h2 class="title sectiontitle">dispatcher command</h2><p class="p">This statistic shows what the dispatcher is
        currently
        doing:</p>
<pre class="pre codeblock"><samp class="ph codeph">dispatcher
     runtime: 45ms
       state: dispatcher_running
      status: running
        task: Running a flusher loop.
nio_dispatcher
       state: dispatcher_running
      status: idle
</samp></pre>
<p class="p">The
        first entry, dispatcher, monitors the process responsible for disk access. The second entry
        is a non-IO (non disk) dispatcher. There may also be a ro_dispatcher dispatcher present if
        the engine is allowing concurrent reads and writes. When a task is actually running on a
        given dispatcher, the “runtime” tells you how long the current task has been running. Newer
        versions will show you a log of recently run dispatcher jobs so you can see what’s been
        happening.</p>
</div>

    
    <div class="section"><h2 class="title sectiontitle">Changing statistics collection</h2>
      <p class="p">The default Couchbase Server statistics
        collection is set to collect every second. The tuning that is available for statistic
        collection is by collecting statistics less frequently. </p>

      <div class="note note"><span class="notetitle">Note:</span> If statistic
        collection is changed from the default, the Couchbase service must be restarted.</div>

      
      <p class="p">To change statistic collection:</p>
<ol class="ol">
        <li class="li">Log in as root or sudo and navigate to the directory where Couchbase is installed. For
          example: <samp class="ph codeph">/opt/couchbase/etc/couchbase/static_config</samp></li>

        <li class="li">Edit the static_config file.</li>

        <li class="li">Add the following parameter: <samp class="ph codeph">grab_stats_every_n_ticks, 10</samp>, where 10 is the number of
          ticks. In the Couchbase environment one tick is one second (default). It is recommended
          that the statistics collection be more frequent (and accurate). However, assign an
          appropriate tick value for you environment.</li>

        <li class="li">Restart the Couchbase service.</li>

      </ol>
<p class="p">After restarting the Couchbase service, the statistics collection rate is changed.</p>
</div>

    
    <div class="section"><h2 class="title sectiontitle">Changing the stats file location</h2><p class="p">The default stats
          file location is <samp class="ph codeph">/opt/couchbase/var/lib/couchbase/stats</samp>, however, if you
          want to change the default stats file location, create a symlink location to the new
          directory.</p>

      <div class="note note"><span class="notetitle">Note:</span> When creating a symlink, stop and restart the Couchbase
          service. </div>
</div>

  </div>

  <div class="related-links">
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a class="link" href="../Monitoring/monitor-intro.html" title="There are a number of different ways to monitor Couchbase servers including underlying processes, ports, and queueing.">Monitoring</a></div>
</div>

<div class="linklist linklist">
<div><a class="link" href="../REST/overview-rest-api.html">REST API overview</a></div>
<div><a class="link" href="../CLI/cbstats-intro.html">cbstats tool</a></div>
<div><a class="link" href="http://github.com/membase/ep-engine/blob/master/docs/stats.org" target="_blank">Detailed stats documentation</a></div></div>
</div>
</main></div></div><footer><div class="navbar navbar-default navbar-fixed-bottom"><div class="container"><div class="copyright"> © 2014 COUCHBASE All rights reserved. </div></div></div></footer><script type="text/javascript" src="https://www.google.com/jsapi"></script><script>
					(function() {
					var cx = '018016427239405524608:fkg1v30apnm';
					var gcse = document.createElement('script');
					gcse.type = 'text/javascript';
					gcse.async = true;
					gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
					'//www.google.com/cse/cse.js?cx=' + cx;
					var s = document.getElementsByTagName('script')[0];
					s.parentNode.insertBefore(gcse, s);
					})();
				</script></body></html>