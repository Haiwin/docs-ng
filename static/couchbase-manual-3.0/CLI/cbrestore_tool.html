<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="description" content="Couchbase Server product documentation"><style>
					body{
						padding-top:40px; /* make the container go all the way to the bottom of the top bar */
					}</style><script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script><link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.min.css" rel="stylesheet"><script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.js"></script><link rel="stylesheet" href="//yandex.st/highlightjs/8.0/styles/default.min.css"><script src="//yandex.st/highlightjs/8.0/highlight.min.js"></script><link href="http://fonts.googleapis.com/css?family=Open+Sans:400italic,400,700" rel="stylesheet" type="text/css"><link href="/assets-dita/css/base.css" rel="stylesheet"><script src="/assets-dita/js/main.js"></script></head><body><header class="navbar navbar-fixed-top"><div class="navbar-inner"><div class="container-fluid container"><a class="brand" href="http://www.couchbase.com/"><img src="/assets-dita/images/cb-icon-sofa.png" class="logo"></a><a class="brand" style="color:#000552;" href="/">Couchbase Documentation <small>beta</small></a><div class="nav-collapse collapse"><ul class="nav"><li><a href="/">Docs Home</a></li><li><a href="/archive-index">Docs Archive</a></li></ul></div></div></div></header><div id="content" class="container-fluid container"><div class="row-fluid"><nav class="span3"><div class="well"><ul class="nav nav-list"><li><a href="../beta-intro.html">Couchbase 3.0 beta introduction</a></li><li><a href="../Features/features.html">Couchbase 3.0 Features</a></li><li><a href="../install-intro.html">Couchbase Installation</a></li><li><a href="../admin-intro.html">Couchbase Administration</a></li><li><a href="../cli-intro.html">Couchbase CLI</a><ul class="nav nav-list"><li><a href="../CLI/cli-overview.html">Command-line interface overview</a></li><li><a href="../CLI/cbanalyze-core_tool.html">cbanalyze-core tool</a></li><li><a href="../CLI/cbbackup_tool.html">cbbackup tool</a></li><li><a href="../CLI/cbcli-intro.html">couchbase-cli tool</a></li><li><a href="../CLI/cbcollect_info_tool.html">cbcollect_info tool</a></li><li><a href="../CLI/cbdocloader_tool.html">cbdocloader tool</a></li><li><a href="../CLI/cbepctl-intro.html">cbepctl tool</a></li><li><a href="../CLI/cbhealthchecker_tool.html">cbhealthchecker tool</a></li><li><a href="../CLI/cbreset_password_tool.html">cbreset_password tool</a></li><li class="active"><a href="../CLI/cbrestore_tool.html">cbrestore tool</a><ul class="nav nav-list"></ul></li><li><a href="../CLI/cbstats-intro.html">cbstats tool</a></li><li><a href="../CLI/cbtransfer_tool.html">cbtransfer tool</a></li><li><a href="../CLI/cbworkloadgen_tool.html">cbworkloadgen tool</a></li></ul></li><li><a href="../rest-intro.html">Couchbase REST API</a></li><li><a href="../rel-notes/rel-notes3.0beta.html">Release notes (beta)</a></li></ul></div></nav><main class="span9">
  <h1 class="title topictitle1">cbrestore tool</h1>

  <div class="body">
    <p class="p">The <samp class="ph codeph">cbrestore</samp> tool restores data from a file to an entire cluster or to a
      single bucket in the cluster. Items that had been written to file on disk will be restored to
      RAM.</p>

    <p class="p"><samp class="ph codeph">cbbackup</samp>, <samp class="ph codeph">cbrestore</samp> and <samp class="ph codeph">cbtransfer</samp> do not
      communicate with external IP addresses for server nodes outside of a cluster. They can only
      communicate with nodes from a node list obtained within a cluster. You should perform backup,
      restore, or transfer to data from a node within a Couchbase cluster. This also means that if
      you install Couchbase Server with the default IP address, you cannot use an external hostname
      to access it. </p>

    <p class="p">The tool is in the following locations, depending on your platform:</p>

    
<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" class="table" frame="border" border="1" rules="all">
        
        
        <thead class="thead" align="left">
          <tr class="row">
            <th class="entry" valign="top" id="d37316e44"><strong class="ph b">Linux</strong></th>

            <th class="entry" valign="top" id="d37316e48"><samp class="ph codeph">/opt/couchbase/bin/cbrestore</samp></th>

          </tr>

        </thead>

        <tbody class="tbody">
          <tr class="row">
            <td class="entry" valign="top" headers="d37316e44 "><strong class="ph b">Windows</strong></td>

            <td class="entry" valign="top" headers="d37316e48 "><samp class="ph codeph">C:\Program&nbsp;Files\Couchbase\Server\bin\cbrestore</samp></td>

          </tr>

          <tr class="row">
            <td class="entry" valign="top" headers="d37316e44 "><strong class="ph b">Mac OS X</strong></td>

            <td class="entry" valign="top" headers="d37316e48 "><samp class="ph codeph">/Applications/Couchbase&nbsp;Server.app/Contents/Resources/couchbase-core/bin/cbrestore</samp></td>

          </tr>

        </tbody>

      </table>
</div>

    <p class="p">The format of the <samp class="ph codeph">cbrestore</samp> command is:</p>

    <pre class="pre codeblock"><samp class="ph codeph">cbrestore [options] [host:ip] [source] [destination]
</samp></pre>

    <p class="p">Where:</p>

    <ul class="ul">
      <li class="li"><samp class="ph codeph">[options]</samp></li>

    </ul>

    <p class="p">Command options for <samp class="ph codeph">cbrestore</samp> are the same options for
        <samp class="ph codeph">cbtransfer</samp>.</p>

    <ul class="ul">
      <li class="li"><samp class="ph codeph">[host:ip]</samp></li>

    </ul>

    <p class="p">Hostname and port for a node in cluster.</p>

    <ul class="ul">
      <li class="li"><samp class="ph codeph">[source]</samp></li>

    </ul>

    <p class="p">Source bucket name for the backup data. This is in the directory created by
        <samp class="ph codeph">cbbackup</samp> when you performed the backup.</p>

    <ul class="ul">
      <li class="li"><samp class="ph codeph">[destination]</samp></li>

    </ul>

    <p class="p">The destination bucket for the restored information. This is a bucket in an existing cluster.
      If you restore the data to a single node in a cluster, provide the hostname and port for the
      node you want to restore to. If you restore an entire data bucket, provide the URL of one of
      the nodes within the cluster.</p>

    <p class="p">All command options for <samp class="ph codeph">cbrestore</samp> are the same options available for
        <samp class="ph codeph">cbtransfer</samp>.</p>

    
    
    
    <div class="section"><h2 class="title sectiontitle">Using cbrestore for design documents</h2>
    <p class="p">You can restore design documents to a server node with the option,
        <samp class="ph codeph">design_doc_only=1</samp>. You can restore from a backup file you create with
        <samp class="ph codeph">cbbackup</samp>.</p>

    <pre class="pre codeblock"><samp class="ph codeph">&gt; ./cbrestore ~/backup http://10.3.1.10:8091 -x design_doc_only=1 -b a_bucket -B my_bucket

transfer design doc only. bucket msgs will be skipped.
done
</samp></pre>

    <p class="p">This will restore design documents from the backup file <samp class="ph codeph">~/backup/a_bucket</samp> to
      the destination bucket <samp class="ph codeph">my_bucket</samp> in a cluster. If you backed up more than one
      source bucket, you will need to perform this command more than once. For instance, imagine you
      did a backup for a cluster with two data buckets and have the backup files
        <samp class="ph codeph">~/backup/bucket_one/design.json</samp> and
        <samp class="ph codeph">~/backup/bucket_two/design.json</samp> :</p>

    <pre class="pre codeblock"><samp class="ph codeph">&gt; ./cbrestore ~/backup http://10.3.1.10:8091 -x design_doc_only=1 -b bucket_one -B my_bucket

&gt; ./cbrestore ~/backup http://10.3.1.10:8091 -x design_doc_only=1 -b bucket_two -B my_bucket
</samp></pre>

    <p class="p">This will restore design documents in both backup files to a bucket in your cluster named
        <samp class="ph codeph">my_bucket</samp> After you restore the design documents you can see them in
      Couchbase Web Console under the Views tab.</p>

    </div>

    
    
    
    <div class="section"><h2 class="title sectiontitle">Using cbrestore for 1.8.x</h2>
    <p class="p">You can use <samp class="ph codeph">cbrestore</samp> to backup data from a Couchbase 1.8.x cluster,
      including 1.8. To do so you use the same command options you use when you backup a 2.0 cluster
      except you provide it the hostname and port for the 1.8.x cluster. You do not need to even
      install Couchbase Server 2.0 in order to use <samp class="ph codeph">cbrestore</samp> 2.0 to backup
      Couchbase Server 1.8.x. . After you get the tool, go to the directory
      where you cloned the tool and perform the command. For instance:</p>

    <pre class="pre codeblock">./cbrestore ~/backup http://10.3.3.11:8091 -u Administrator -p password -B saslbucket_destination -b saslbucket_source
</pre>

    <p class="p">This restores all data in the <samp class="ph codeph">bucket-saslbucket_source</samp> directory under
        <samp class="ph codeph">~/backups</samp> on the physical machine where you run <samp class="ph codeph">cbbackup</samp>.
      It will restore this data into a bucket named <samp class="ph codeph">saslbucket_destination</samp> in the
      cluster with the node host:port of <samp class="ph codeph">10.3.3.11:8091</samp>.</p>

    <p class="p">Be aware that if you are trying to restore data to a different cluster, that you should make
      sure that cluster should have the same number of vBuckets as the cluster that you backed up.
      If you attempt to restore data from a cluster to a cluster with a different number of
      vBuckets, it will fail when you use the default port of <samp class="ph codeph">8091</samp>. The default
      number of vBuckets for Couchbase 2.0 is 1024; in earlier versions of Couchbase, you may have a
      different number of vBuckets. If you do want to restore data to a cluster with a different
      number of vBuckets, you should perform this command with port <samp class="ph codeph">11211</samp>, which
      will accommodate the difference in vBuckets:</p>

    <pre class="pre codeblock">cbrestore /backups/backup-42 memcached://HOST:11211 \
    --bucket-source=sessions --bucket-destination=sessions2
</pre>

    </div>

    
  </div>

  <div class="related-links">
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a class="link" href="../cli-intro.html">Couchbase CLI</a></div>
</div>

<div class="linklist linklist"><strong>Related topics</strong><br>

<div><a class="link" href="https://github.com/couchbase/couchbase-cli" target="_blank">Couchbase command-line tools GitHub repository</a></div>
<div><a class="link" href="../Install/hostnames.html">Using hostnames</a></div>
<div><a class="link" href="../UI/ui-views-editor.html" title="The Views section allows you to manage your development and production views.">Views</a></div>
<div><a class="link" href="../CLI/cbbackup_tool.html" title="The cbbackup tool creates a copy of data from an entire running cluster, an entire bucket, a single node, or a single bucket on a single functioning node. Your node or cluster needs to be functioning in order to create the backup. Couchbase Server will write a copy of data onto disk.">cbbackup tool</a></div>
<div><a class="link" href="../CLI/cbtransfer_tool.html">cbtransfer tool</a></div></div>
</div>
</main></div></div><footer><div class="navbar navbar-fixed-bottom"><div class="navbar-inner"><div class="container-fluid container"><div class="copyright">
								© 2014 COUCHBASE All rights reserved.
							</div></div></div></div></footer></body></html>